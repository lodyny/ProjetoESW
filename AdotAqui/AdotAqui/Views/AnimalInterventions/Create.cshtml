@model AdotAqui.Models.Entities.AnimalIntervention
@using Microsoft.Extensions.Localization;
@inject IStringLocalizer<SharedResources> SharedLocalizer

@{
    ViewData["Title"] = @SharedLocalizer["Label_Create"];
}

@section DocumentReadyScripts {
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })

    imgid = $("#animalID").val();
    previousTarget = $("#img_" + imgid).parent().parent();
    $("#img_" + imgid).parent().parent().css({
    'border': '2px solid rgb(0, 0, 0)'
    });



}

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>

        function animalChange() {
            console.log($("#animalID").val());
            imgid = $("#animalID").val();


            if (previousTarget) {
                previousTarget.css({
                    'border': '1px solid rgba(0, 0, 0, .125)'
                });
            }
            previousTarget = $("#img_" + imgid).parent().parent();

            $("#img_" + imgid).parent().parent().css({
                'border': '2px solid rgb(0, 0, 0)'
            });
        };

        var previousTarget;

        function getAnimal(e, id) {
            $("#animalID").val(id);

            if (previousTarget) {
                previousTarget.css({
                    'border': '1px solid rgba(0, 0, 0, .125)'
                });
            }
            previousTarget = $(e.target).parent().parent();

            $(e.target).parent().parent().css({
                'border': '2px solid rgb(0, 0, 0)'
            });
        }
    </script>
}

<link rel="stylesheet" href="~/lib/bootstrap/css/bootstrap-datepicker.css" />
<script src="~/lib/bootstrap/js/bootstrap-datepicker.js"></script>
<script src="~/lib/jquery/adopreq-validation.js"></script>



<h2>@SharedLocalizer["Label_CreateTask"]</h2>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Create">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="Date" class="control-label">@SharedLocalizer["Label_Date"]</label>


                <div class="input-group date" id="datepicker_start">
                    <input asp-for="Date" class="form-control" type="text" readonly>
                    <div class="input-group-append">
                        <span class="input-group-text input-group-addon"><i class="fas fa-calendar-alt"></i></span>
                    </div>
                </div>

                <span asp-validation-for="Date" class="text-danger"></span>
            </div>
            <div class="form-group">
                <div class="checkbox">
                    <label>
                        <input asp-for="Completed" type="hidden" />
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label asp-for="Details" class="control-label">@SharedLocalizer["Label_Details"]</label>
                <textarea asp-for="Details" class="form-control"></textarea>
                <span asp-validation-for="Details" class="text-danger"></span>
            </div>
            <div class="form-group">
                Animal
                <select id="animalID" name="animalID" class="form-control" onchange="animalChange()">
                    @foreach (Animal animal in ViewBag.Animals)
                    {
                        <option value="@animal.AnimalId">@Html.DisplayFor(modelItem => animal.Name)</option>
                    }
                </select>
            </div>
            <div class="form-group">
                @SharedLocalizer["Label_Vet"]
                <select id="userID" name="userID" class="form-control">
                    @foreach (User user in ViewBag.Users)
                    {
                        <option value="@user.Id">@Html.DisplayFor(modelItem => user.Email)</option>
                    }
                </select>
            </div>
            <div class="form-group">
                <input type="submit" value="@SharedLocalizer["Label_Create"]" class="btn btn-default">
            </div>
        </form>
    </div>

    <div class="col">




        <div class="container">

            <div class="card-deck">
                @{
                    int counter = 1;
                    foreach (var animal in ViewBag.Animals)
                    {
                        <div class="card mb-4">
                            @if (animal.Image == null)
                            {
                                <a href="#" onclick="getAnimal(event, @animal.AnimalId)" style="color:black;text-decoration:none;">
                                    <img id="img_@animal.AnimalId" class="card-img-top img-fluid" src="https://via.placeholder.com/500x500" alt="Card image cap">
                                </a>
                            }
                            else
                            {
                                <a href="#" onclick="getAnimal(event, @animal.AnimalId)" style="color:black;text-decoration:none;">
                                    <img id="img_@animal.AnimalId" class="card-img-top img-fluid" style="width: 100%; height: 15vw; object-fit: cover;" src="@animal.Image" alt="Card image cap">
                                </a>
                            }
                            @if (this.User.IsInRole("Administrator"))
                            {
                                <span style="position: absolute;right: 0;margin-right:2px;" id="editTool" data-toggle="tooltip" data-placement="top" title="@SharedLocalizer["Label_Edit"]"><a asp-controller="Animals" asp-action="Edit" asp-route-id="@animal.AnimalId"><i class="fas fa-edit"></i></a></span>
                            }
                            @if (animal.Gender.Equals("M"))
                            {
                                <span style="position:absolute;right:0;bottom:0;margin-right:5px;color:dodgerblue;font-size:18px;"><i class="fas fa-mars"></i></span>
                            }
                            else
                            {
                                <span style="position:absolute;right:0;bottom:0;margin-right:5px;color:#E75480;font-size:18px;"><i class="fas fa-venus"></i></span>
                            }
                            <div>
                                <h5 class="card-title" style="text-align:center;margin-top:10px;">
                                    @animal.Name
                                </h5>
                            </div>
                        </div>
                        if (counter % 2 == 0)
                        {
                            <div class="w-100 d-none d-sm-block d-md-none"><!-- wrap every 2 on sm--></div>
                        }
                        if (counter % 3 == 0)
                        {
                            <div class="w-100 d-none d-md-block d-lg-none"><!-- wrap every 3 on md--></div>
                        }
                        if (counter % 4 == 0)
                        {
                            <div class="w-100 d-none d-lg-block d-xl-none"><!-- wrap every 4 on lg--></div>
                        }
                        if (counter % 5 == 0)
                        {
                            <div class="w-100 d-none d-xl-block"><!-- wrap every 5 on xl--></div>
                        }
                        counter = counter + 1;
                    }
                }
            </div>
        </div>






    </div>

</div>
<div>
    <a asp-action="Index">@SharedLocalizer["Label_Back"]</a>
</div>
